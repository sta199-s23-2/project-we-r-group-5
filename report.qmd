---
title: "Wanna be rich? Here's how!"
subtitle: "A statistical analysis regarding which industry has the highest number of billionaires based on their continent"
format: html
editor: visual
execute:
  echo: true
---

#### Introduction and data

Our topic focus on the dataset "Billionaires" (2016), which contains information on the Billionaires in the world in 1996, 2001, 2014. The dataset involves information on each billionaire such as their country, wealth worth, wealth type, industry, etc. Using some of these variables, we came up with a question that helps us gather more insight on the wealth world, which is helpful for those who are deciding which industry to enter in different countries.

Research Question and Hypothesis:

-   How has the relationship between wealth worth and industry among billionaires changed in each continent as time goes on?

To answer our full question, based on our prior background knowledge, we predict that the number of billionaires involved in the industry of technology-computer will increase as time goes by because technology is an industry that is growing rapidly. More broadly speaking, we hypothesize that each continent has a different industry that contains the most billionaires, as each continent has very different resources to offer to the world. Additionally, we hypothesize that North America will have the most billionaires, followed by Asia. However, we also acknowledge that each continent is very different, so our prior background knowledge may only apply to North America, where we reside.

The data was from the CORGIS Dataset Project, collected by Ryan Whitcombwas in 1996, 2001, and 2014. We are using data from all three years to see how the wealth industries have changed over time by comparing data about the wealth industries from each provided year. It compiled Forbes World's Billionaires list and shows a record number of billionaires in the world while adding detailed information on the individuals listed. The relevant variables include the year, wealth worth, industry, and their continent. In total, the data set has 22 columns and 2614 observations.

#### Methodology

Our methodology involves creating a table that counts the number of billionaires per continent in 2014. This gives us an overview of the numbers alone, industry aside. Next, in order to also compare industry and wealth worth, we thought it would be best to create a bar plot for each continent. Thus we used facet wrap to create multiple side-by-side plots that depict the relationship between industry and wealth worth.

```{r}
#| label: load-pkgs
#| message: false

library(tidyverse)
library(tidymodels)
```

```{r}
#| label: load-data-2014
#| fig-width: 20
#| message: false

#Load data
billionaires <- read_csv("data/billionaires.csv")

df_1 <- billionaires|>
  dplyr::select(year, name, "wealth.worth in billions", wealth.how.industry, location.region, location.citizenship)|>
  rename_with(~'wealth.worth.billions', "wealth.worth in billions")|>
  mutate(continent = case_when(
    location.region == "Latin America" & location.citizenship == "Mexico" ~ "North America",
    TRUE ~ location.region
  ))

df_1
```

```{r}
#| label: mean_wealth_1996

df_1996 <- df_1 |>
  filter(year == 1996) |>
  filter(wealth.how.industry != 0) |>
  filter(location.region == "North America") |>
  group_by(wealth.how.industry) |>
  summarize(mean_wealth = mean(wealth.worth.billions, na.rm = T)) |>
  mutate(year = if_else(mean_wealth != 0, 1996, 0))
  

```

```{r}
#| label: mean_wealth_2001

df_2001 <- df_1 |>
  filter(year == 2001) |>
  filter(wealth.how.industry != 0) |>
  filter(location.region == "North America") |>
  group_by(wealth.how.industry) |>
  summarize(mean_wealth = mean(wealth.worth.billions, na.rm = T))|>
  mutate(year = if_else(mean_wealth != 0, 2001, 0))
```

```{r}
#| label: mean_wealth_2014

df_2014 <- df_1 |>
  filter(year == 2014) |>
  filter(wealth.how.industry != 0) |>
  filter(location.region == "North America") |>
  group_by(wealth.how.industry) |>
  summarize(mean_wealth = mean(wealth.worth.billions, na.rm = T))|>
  mutate(year = if_else(mean_wealth != 0, 2014, 0))
```

```{r}
#| label: visualization
#| fig-width: 10
#df_combined <- left_join(df_2001, df_1996, by = "wealth.how.industry")

#df_combined <- left_join(df_combined, df_2014, by = "wealth.how.industry")

distinct_colors <- c("#a6cee3", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99", "#e31a1c", "#fdbf6f",
                     "#ff7f00", "#cab2d6", "#6a3d9a", "#ffff99", "#b15928", "#8dd3c7", "#bebada",
                     "#fb8072", "#80b1d3", "grey")

df_rbind <- rbind(df_1996, df_2001)
df_rbind <- rbind(df_rbind, df_2014)

df_rbind |>
  ggplot(
    aes(x = year,
        y = mean_wealth,
        color = wealth.how.industry))+
  geom_line() +
  geom_point() +
  scale_x_continuous(limits = c(1996, 2014.5), breaks = c(1996, 2001, 2014)) +
  scale_color_manual(values = distinct_colors)

```

```{r}
#| label: graph-2014

df_1 |>
  filter(wealth.how.industry != 0) |>
  ggplot(
    aes(x = wealth.how.industry, y = wealth.worth.billions, fill = wealth.how.industry)) +
    geom_col() + 
  facet_wrap("continent") +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(title = "Relationship Between Wealth Worth and Industry\nAmong the Billionaires in each Continent in 2014", 
       x = "Industry", 
       y = "Wealth Worth(billions)",
       fill = "Industry type") +
  theme(plot.title = element_text(size = 14)) +
  theme(legend.text = element_text(size = 7)) +
  theme(legend.title = element_text(size = 13)) +
  theme(axis.text.x = element_blank())

```

```{r}
#| label: load-data-2001
#| fig-width: 20
#| message: false
billionaires <- read_csv("data/billionaires.csv")

df_2 <- billionaires|>
  filter(year == 2001)|>
  dplyr::select(name, "wealth.worth in billions", wealth.how.industry, location.region, location.citizenship)|>
  rename_with(~'wealth.worth.billions', "wealth.worth in billions")|>
  mutate(continent = case_when(
    location.region %in% c("East Asia", "South Asia") ~ "Asia",
    location.region == "Middle East/North Africa" ~ "Africa",
    location.region == "Sub-Saharan Africa" ~ "Africa",
    location.region == "Latin America" & location.citizenship == "Mexico" ~ "North America",
    TRUE ~ location.region
  ))
```

```{r}
#| label: graph-2001
df_2 |>
  filter(continent != 0) |>
  filter(wealth.how.industry != 0) |>
  ggplot(
    aes(x = wealth.how.industry, y = wealth.worth.billions, fill = wealth.how.industry)) +
    geom_col() + 
  facet_wrap("continent") +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(title = "Relationship Between Wealth Worth and Industry\nAmong the Billionaires in each Continent in 2001", 
       x = "Industry", 
       y = "Wealth Worth(billions)",
       fill = "Industry type") +
  theme(plot.title = element_text(size = 14)) +
  theme(legend.text = element_text(size = 7)) +
  theme(legend.title = element_text(size = 13)) +
  theme(axis.text.x = element_blank())

```

```{r}
#| label: load-data-1996
#| fig-width: 20
#| message: false
billionaires <- read_csv("data/billionaires.csv")

df_3 <- billionaires|>
  filter(year == 1996)|>
  dplyr::select(name, "wealth.worth in billions", wealth.how.industry, location.region, location.citizenship)|>
  rename_with(~'wealth.worth.billions', "wealth.worth in billions")|>
  mutate(continent = case_when(
    location.region %in% c("East Asia", "South Asia") ~ "Asia",
    location.region == "Middle East/North Africa" ~ "Africa",
    location.region == "Sub-Saharan Africa" ~ "Africa",
    location.region == "Latin America" & location.citizenship == "Mexico" ~ "North America",
    TRUE ~ location.region
  ))
```

```{r}
#| label: graph-1996
df_3 |>
  filter(continent != 0) |>
  filter(wealth.how.industry != 0) |>
  ggplot(
    aes(x = wealth.how.industry, y = wealth.worth.billions, fill = wealth.how.industry)) +
    geom_col() + 
  facet_wrap("continent") +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(title = "Relationship Between Wealth Worth and Industry\nAmong the Billionaires in each Continent in 1996", 
       x = "Industry", 
       y = "Wealth Worth(billions)",
       fill = "Industry type") +
  theme(plot.title = element_text(size = 14)) +
  theme(legend.text = element_text(size = 7)) +
  theme(legend.title = element_text(size = 13)) +
  theme(axis.text.x = element_blank())
```

```{r}
#|: label: Logistic_regression
df_1$wealth.how.industry <- as.factor(df_1$wealth.how.industry)
#My friend's model:
model_2a <- logistic_reg() |>
  set_engine("glm") |>
  fit(wealth.how.industry ~ wealth.how.industry * wealth.worth.billions,
      data = df_1,
      family = "binomial") |>
  tidy()
model_2a

#My model:
model_2b <- logistic_reg() |>
  set_engine("glm") |>
  fit(wealth.how.industry ~ wealth.how.industry + wealth.worth.billions,
      data = df_1,
      family = "binomial") |>
  tidy()
model_2b

AIC_1 <- logistic_reg() |>
  set_engine("glm") |>
  fit(wealth.how.industry ~ wealth.how.industry * wealth.worth.billions,
        data = df_1,
        family = "binomial")|>
  glance() |>
  pull(AIC)
AIC_1
  #My model
AIC_2 <- logistic_reg() |>
  set_engine("glm") |>
  fit(wealth.how.industry ~ wealth.how.industry + wealth.worth.billions,
        data = df_1,
        family = "binomial") |>
  glance() |>
  pull(AIC)
AIC_2
```

```{r}
df_technology_2014 <- df_1|>
  filter(wealth.how.industry == "Technology-Computer")|>
  dplyr::select(wealth.worth.billions, wealth.how.industry)|>
  dplyr::mutate(wealth.how.industry = "2014")

df_technology_2001 <- df_2|>
  filter(wealth.how.industry == "Technology-Computer")|>
  dplyr::select(wealth.worth.billions, wealth.how.industry)|>
  dplyr::mutate(wealth.how.industry = "2001")

df_technology_2014<- df_technology_2014|>
  group_by(wealth.how.industry) |>
  summarize(mean_wealth = mean(wealth.worth.billions, na.rm = T))

df_technology_2001<- df_technology_2001|>
  group_by(wealth.how.industry) |>
  summarize(mean_wealth = mean(wealth.worth.billions, na.rm = T))

df_technology_2001_2014 <- rbind(df_technology_2014, df_technology_2001)
  estimate <- 5.225954-4.636364

```

```{r}
df_technology_2014 <- df_1|>
  filter(wealth.how.industry == "Technology-Computer")|>
  dplyr::select(wealth.worth.billions, wealth.how.industry)


df_technology_2001<- df_2|>
  filter(wealth.how.industry == "Technology-Computer")|>
  dplyr::select(wealth.worth.billions, wealth.how.industry)

```

```{r}
df_technology_2014|>
  filter(!is.na(wealth.worth.billions))|>
  count(wealth.how.industry)

df_technology_2001|>
  filter(!is.na(wealth.worth.billions))|>
  count(wealth.how.industry)

sd1 <- df_technology_2014|>
  summarize(sd_a = sd(wealth.worth.billions, na.rm = T)) |>
  as.numeric()
n1 <-131

sd2 <- df_technology_2001|>
  summarize(sd_a = sd(wealth.worth.billions, na.rm = T)) |>
  as.numeric()
n2 <-55

tscore <- (estimate - 0) / sqrt(((sd1^2)/n1) + ((sd2^2)/n2))
pt(tscore, df= 184.5772 , lower.tail = F)
```

#### Results

-   To answer our research question, we created a plot to visualize the relationship between industry and wealth worth, with industry being on the x-axis and wealth worth in billions on the y-axis. Additionally, in order to compare these variables by continent, we used facet wrap to make multiple plots next to each other. This visualization made it easy for us to draw conclusions to our question.

-   From the table depicting the number of billionaires per continent in 2014, we found that overall, North America had the most billionaires (as our hypothesis stated), followed by Europe and then Asia. This does not line up with the prediction, as we had predicted Asia to come first. For industry, we found that technology-computer was in fact the industry with the most billionaires in North America. However, it was found that each continent had a very different turn out regarding which industry was the most successful. For Europe and Latin America, the industry with the most billionaires was the consumer industry; for Africa, the diversified financial industry; and for Asia, the real estate industry.

**Citation and Reference**

-   "Billionaires CSV File" from the CORGIS Dataset Project. By Ryan Whitcomb, Version 2.0.0, created on 5/17/2016.
